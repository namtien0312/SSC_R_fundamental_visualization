<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Trình bày kết quả nghiên cứu với R - Bài 2 - SSC</title>
    <meta charset="utf-8" />
    <meta name="author" content="Tien N.T.Nguyen" />
    <script src="libs/header-attrs-2.14/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/tile-view-0.2.6/tile-view.css" rel="stylesheet" />
    <script src="libs/tile-view-0.2.6/tile-view.js"></script>
    <script src="libs/fabric-4.3.1/fabric.min.js"></script>
    <link href="libs/xaringanExtra-scribble-0.0.1/scribble.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-scribble-0.0.1/scribble.js"></script>
    <script>document.addEventListener('DOMContentLoaded', function() { window.xeScribble = new Scribble({"pen_color":["#FF0000"],"pen_size":3,"eraser_size":30,"palette":[]}) })</script>
    <script src="libs/xaringanExtra_fit-screen-0.2.6/fit-screen.js"></script>
    <link href="libs/xaringanExtra-extra-styles-0.2.6/xaringanExtra-extra-styles.css" rel="stylesheet" />
    <script src="libs/mark.js-8.11.1/mark.min.js"></script>
    <link href="libs/xaringanExtra-search-0.0.1/search.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-search-0.0.1/search.js"></script>
    <script>window.addEventListener('load', function() { window.xeSearch = new RemarkSearch({"position":"bottom-left","caseSensitive":false,"showIcon":true,"autoSearch":true}) })</script>
    <script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
    <link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
    <script src="libs/datatables-binding-0.22/datatables.js"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
    <script src="libs/jszip-1.11.3/jszip.min.js"></script>
    <link href="libs/dt-ext-buttons-1.11.3/css/buttons.dataTables.min.css" rel="stylesheet" />
    <script src="libs/dt-ext-buttons-1.11.3/js/dataTables.buttons.min.js"></script>
    <script src="libs/dt-ext-buttons-1.11.3/js/buttons.html5.min.js"></script>
    <script src="libs/dt-ext-buttons-1.11.3/js/buttons.colVis.min.js"></script>
    <script src="libs/dt-ext-buttons-1.11.3/js/buttons.print.min.js"></script>
    <link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
    <script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
    <link rel="stylesheet" href="sydney-fonts.css" type="text/css" />
    <link rel="stylesheet" href="sydney.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">

class: center, middle



<div>
<style type="text/css">.xaringan-extra-logo {
width: 110px;
height: 100px;
z-index: 0;
background-image: url(ssc_logo.png);
background-size: contain;
background-repeat: no-repeat;
position: absolute;
top:0.05em;right:0.56em;
}
</style>
<script>(function () {
  let tries = 0
  function addLogo () {
    if (typeof slideshow === 'undefined') {
      tries += 1
      if (tries < 10) {
        setTimeout(addLogo, 100)
      }
    } else {
      document.querySelectorAll('.remark-slide-content:not(.title-slide):not(.inverse):not(.hide_logo)')
        .forEach(function (slide) {
          const logo = document.createElement('div')
          logo.classList = 'xaringan-extra-logo'
          logo.href = null
          slide.appendChild(logo)
        })
    }
  }
  document.addEventListener('DOMContentLoaded', addLogo)
})()</script>
</div>







.title[.bold[Trình bày kết quả nghiên cứu với R]]

.font120[
**Bài 3: Vẽ một số biểu đồ thường gặp với R**
]

&lt;style&gt;
.title {
  font-size: 56px;
  font-family: 'Roboto', Arial, sans-serif;
  color: #008080;
}
&lt;/style&gt;

&lt;img src="R_Rstudio.png" width="200px"/&gt;

&lt;/br&gt;
Tien N.T.Nguyen | Trung tâm .orange[DI] &amp; .blue[ADR] Quốc gia, HUP | 20 May. 2022


---
### .ssc[Đọc các file sử dụng cho buổi hôm nay]


```r
df1 = read.csv("E:/SSC_R_visu/data_ggplot2_layer.csv")
df_bar = read_xlsx("E:/SSC_R_visu/bar_error_bar.xlsx", sheet = "No_Error_bar")
df_bar_error = read_xlsx("E:/SSC_R_visu/bar_error_bar.xlsx", sheet = "With_error_bar")
df_evo_1 = read_xlsx("E:/SSC_R_visu/Anbio_asump.xlsx", sheet = "Tidy")
names(df_evo_1) = c("Time", "Year", "Month", "Drug", "DDD")
df_evo_2 = read_xlsx("E:/SSC_R_visu/PK_data.xlsx")
df_table = read_xlsx("E:/SSC_R_visu/data_table.xlsx")
```

**Lưu ý: Đây đều là dữ liệu có sẵn/tự tạo -&gt; sử dụng mà không cần sự cho phép**

---
### .ssc[Biểu diễn phân bố với biểu đồ hộp (boxplot)]

--
&lt;br&gt;
.center[
&lt;img src="box_normal.png" width="60%" height="60%" /&gt;
]

---
### .ssc[`df1` dataset]

<div id="htmlwidget-57ae5fcc1387d898f6a5" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-57ae5fcc1387d898f6a5">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[[11001,11002,11003,11005,11006,11007,11008,11009,11010,11011,11012,11013,11014,11015,11016,11017,11018,11019,11020,11004,21001,21002,21003,21004,21005,21006,21007,21008,21009,21010,21011,21012,21013,21014,21015,21016,21017,21018,21019,21020,101,104,105,106,107,108,109,110,111,112,113,114,115,116,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416],[25,23,23,49,29,28,44,45,44,40,52,25,33,37,45,22,26,29,46,47,43,47,24,26,39,46,25,45,44,31,36,26,20,39,27,27,23,21,25,21,39,27,30,41,24,38,39,29,26,45,30,38,36,38,41,37,37,37,25,35,43,35,28,45,44,25,39,45,44,66,66,67,74,66,68,72,66,72,71,70,68,76,67,65,32,26,20,21,24,32,26,21,29,32,20,20,19,21,30,21],[90.7,53.8,80.8,62.9,74.3,63.2,62.1,83.2,88,54.5,68.9,92.4,87.7,87.2,65.9,73.5,71.5,64.5,77.4,67.2,76,91,89.5,94,72,75,76,89,65,69,70,70,58,77,68,99,66,75,80,78,74.7,101,84.5,81,87.5,71,72.4,59.8,95,75,75.9,61.8,94.5,65,67,72,96,93,64,77,81,89,81,81,82,76,81,73,91,64,86,76,90,68,80,71,72,76,74,90,80,89,89,77,80.6,50.2,65.8,58.9,55.4,67.2,69.9,80.4,67.7,97.7,68.4,64.7,83.4,72.3,84.6,84.6],[178.9,168.4,181.9,160.5,179,168,168.5,180.1,176.5,166.5,162.8,178.3,180.4,180,172.5,174,179,161.5,177.5,173.1,166,177,176,180,166,165,167,185,159,165,171,174,155,171,162,182,178,180,175,170,178,187,171.5,172.5,176.5,172,166,151,175,176,180.5,166.5,176,181,180,184,178,181,170,186,175,183,177,178,184,191,180,180,192,166,178,174,184,183,169,161,167,182,173,188,171,172,183,176,180.5,161,170.5,161.5,161.5,169,169,179,160,186,161.7,169,177.5,175,163.5,185.5],["Male","Male","Male","Female","Male","Male","Female","Male","Male","Female","Female","Male","Male","Male","Female","Male","Male","Female","Male","Male","Female","Male","Male","Male","Female","Female","Female","Male","Female","Female","Male","Male","Female","Male","Female","Male","Male","Female","Male","Female","Male","Male","Male","Male","Male","Male","Female","Female","Male","Male","Female","Female","Male","Male","Male","Male","Male","Male","Male","Male","Male","Male","Male","Male","Male","Male","Male","Male","Male","Male","Male","Male","Male","Male","Male","Male","Male","Male","Male","Male","Male","Male","Male","Male","Male","Female","Male","Female","Female","Male","Male","Male","Female","Male","Female","Female","Male","Male","Female","Male"],[3,3,1,1,3,3,1,1,1,3,1,2,1,1,1,3,1,1,1,3,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4,1,1,3,3,1,1,1,1,1,3,3,1,1],[181.1,97.1,131.3,96.5,127.3,98.3,117.3,122,106.7,91.9,119.3,123,144.8,178.2,105.6,133.8,125.8,120.7,126.3,124,145.1,98,144.2,135.3,107.3,118.9,147.4,130.5,81.9,111,91.9,110.8,117.4,120,151.2,172.6,134.1,117.1,142,109.6,104.8,144.1,99.3,101.3,128.2,91.4,107.9,130.6,115.7,110,89.6,93,105,102.3,92.1,114.4,196.2,166.3,127.8,112.3,90.9,162.2,126,106.9,136.7,134.9,126.3,107,134.8,94,98.2,96.3,91.7,99.8,80,83.8,82.2,79.8,78.8,97.2,80,87.9,112.8,80.2,109.9,96.5,137.1,118.2,108.4,112,138.3,147.6,147.9,122.1,121.1,101.8,140.2,119.5,183.1,155.4],["Yes","Yes","Yes","Yes","No","Yes","No","Yes","No","Yes","No","No","No","Yes","No","Yes","Yes","Yes","No","No","Yes","No","Yes","Yes","No","Yes","No","No","No","Yes","Yes","Yes","Yes","No","No","Yes","Yes","Yes","Yes","Yes","No","No","Yes","Yes","No","Yes","Yes","Yes","No","No","No","Yes","Yes","No","Yes","Yes","No","No","No","Yes","Yes","No","Yes","No","Yes","Yes","No","No","Yes","No","No","Yes","No","Yes","Yes","Yes","Yes","No","Yes","Yes","Yes","No","Yes","No","No","No","Yes","No","Yes","Yes","No","No","No","Yes","Yes","Yes","No","No","No","No"]],"container":"<table class=\"compact\">\n  <thead>\n    <tr>\n      <th>ID<\/th>\n      <th>AGE<\/th>\n      <th>WEIGHT<\/th>\n      <th>HEIGHT<\/th>\n      <th>GENDER<\/th>\n      <th>RACE<\/th>\n      <th>CRCL<\/th>\n      <th>Dai_thao_duong<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"tBp","buttons":["copy","excel"],"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[0,1,2,3,5,6]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>

---
### .ssc[Distribution plot - boxplot]

.pull-left[

```r
ggplot(data = df1, aes(x = GENDER, y = AGE)) +
* geom_boxplot() +
  theme_minimal()
```
]

--
.pull-right[
&lt;img src="SSC_R_visu_Bai3_some_graph_files/figure-html/boxplot1-1.png" width="672" /&gt;
]

---
### .ssc[Distribution plot - boxplot]

.pull-left[
`Fill` màu box bằng biến `GENDER`

```r
ggplot(data = df1, aes(x = GENDER, y = AGE)) +
  geom_boxplot(
*   aes(fill = GENDER)
  ) +
  theme_minimal()
```
]

--
.pull-right[
&lt;img src="SSC_R_visu_Bai3_some_graph_files/figure-html/boxplot2-1.png" width="672" /&gt;
]

---
### .ssc[Distribution plot - boxplot - một số tùy chỉnh cơ bản]

&lt;u&gt;**Lưu ý:**&lt;/u&gt; Các `đôi số` (ví dụ `alpha`, `width`, `fill`, `color`,...) sử dụng tương tự cho các `geom_` khác. Sử dụng trong lệnh `aes()` nếu muốn `mapping`. Trong trường hợp này đang `map` màu của box (`fill`) cho `GENDER`
.pull-left[

```r
ggplot(data = df1, aes(x = GENDER, y = AGE)) +
  geom_boxplot(
    aes(fill = GENDER),
    # Thay đổi size của outliers points
    outlier.size = 0.5,   
    # Thay đổi độ rộng của box
    width = 0.52,
    # Thay đổi độ mờ của box
    alpha = 0.48,
    # Thay đổi màu và độ dày đường viền ngoài
    color = "black",
    size = 1
  ) +
  theme_bw()
```
]

--
.pull-right[
&lt;img src="SSC_R_visu_Bai3_some_graph_files/figure-html/boxplot3-1.png" width="672" /&gt;
]

---
### .ssc[Distribution plot - boxplot - một số tùy chỉnh cơ bản]

Ví dụ nếu muốn màu viền `map` theo `GENDER` thì để đối số `color` trong hàm `aes()`
.pull-left[

```r
ggplot(data = df1, aes(x = GENDER, y = AGE)) +
  geom_boxplot(
    aes(fill = GENDER, 
*       color = GENDER),
    # Thay đổi size của outliers points
    outlier.size = 0.5,    
    # Thay đổi độ rộng của box
    width = 0.52,
    # Thay đổi độ mờ của box
    alpha = 0.48,
    # Thay đổi màu và độ dày đường viền ngoài
    size = 1
  ) +
  theme_minimal()
```
]

--
.pull-right[
&lt;img src="SSC_R_visu_Bai3_some_graph_files/figure-html/boxplot_color-1.png" width="672" /&gt;
]

---
### .ssc[Distribution plot - boxplot]

.pull-left[
Boxplot with Jitter plot - **Kết hợp layer**

```r
ggplot(data = df1, aes(x = GENDER, y = AGE)) +
  geom_boxplot(
    aes(fill = GENDER), outlier.size = 0.8, width = 0.42,
    alpha = 0.48, color = "black", size = 1
  ) +
* geom_jitter(
    aes(color = GENDER),
    alpha = 0.38, size = 2
  ) +
  theme_bw()
```
]

--
.pull-right[
&lt;img src="SSC_R_visu_Bai3_some_graph_files/figure-html/boxplot4-1.png" width="672" /&gt;
]

---
class: center, middle
# .ssc[Biểu diễn tương quan - Correlation plot]

---
### .ssc[Correlation - scatter plot]

.pull-left[
Tương quan tuổi và chức năng thận

```r
ggplot(data = df1, aes(x = AGE, y = CRCL)) +
* geom_point(
    aes(
      color = GENDER, # Chỉnh màu theo GENDER
      shape = GENDER  # Chỉnh shape theo GENDER
    )
  ) +
  theme_minimal()
```
]

--
.pull-right[
&lt;img src="SSC_R_visu_Bai3_some_graph_files/figure-html/scat-1.png" width="672" /&gt;
]

---
### .ssc[Correlation - Correlogram]

Tương quan giữa các biến liên tục
.pull-left[

```r
*ggcorr(
  data = df1,
  label      = TRUE,  # hiển thị hệ số r,
  label_size = 3,     # cỡ chữ hệ số r
  size       = 4      # cỡ chữ tên biến (AGE, CRCL, ...)    
) + 
  theme_bw() +
  labs(title = "Correlation Matrix",
       subtitle = "Correlation Coefficients for continuous variables")
```
]

--
.pull-right[
&lt;img src="SSC_R_visu_Bai3_some_graph_files/figure-html/Correlogram1-1.png" width="4667" /&gt;
]

---
### .ssc[Correlation - Correlogram]

Tương quan giữa các biến liên tục
.pull-left[
Chỉnh break cho hệ số r

```r
ggcorr(  
  data = df1,
  label      = TRUE,  
  label_size = 3,     
  size       = 4,        
* nbreaks    = 5
) + 
  theme_bw() +
  labs(title = "Correlation Matrix",
       subtitle = "Correlation Coefficients for continuous variables")
```
]

--
.pull-right[
&lt;img src="SSC_R_visu_Bai3_some_graph_files/figure-html/Correlogram2-1.png" width="4667" /&gt;
]


---
### .ssc[Correlation - Correlogram]

Biến liên tục
.pull-left[

```r
*ggpairs(
  data = df1,
  # Lưu ý tên biến lúc này phải biểu diễn như character
  columns = c("AGE", "HEIGHT", "WEIGHT", "CRCL"),
) + 
  theme_bw() +
  labs(title = "Correlogram graph")
```
]

--
.pull-right[
&lt;img src="SSC_R_visu_Bai3_some_graph_files/figure-html/Correlogram3-1.png" width="672" /&gt;
]

---
### .ssc[Correlation - Correlogram]

Biến liên tục -&gt; chia màu theo biến phân loại (`factor`)
.pull-left[

```r
ggpairs(
  data = df1,
  # Lưu ý tên biến lúc này phải biểu diễn như character
  columns = c("AGE", "HEIGHT", "WEIGHT", "CRCL"),
* aes(color = df1$GENDER,
      alpha = 0.5)         
) + 
  theme_bw() +
  labs(title = "Correlogram graph")
```
]

--
.pull-right[
&lt;img src="SSC_R_visu_Bai3_some_graph_files/figure-html/Correlogram4-1.png" width="672" /&gt;
]

---
### .ssc[Correlation - Correlogram]

Có thêm biến phân loại
.pull-left[

```r
ggpairs( 
  data = df1,
  # Lưu ý tên biến lúc này phải biểu diễn như character
  columns = c("AGE", "HEIGHT", "WEIGHT", "CRCL", "GENDER"),
) + 
  theme_bw() +
  labs(title = "Correlogram graph")
```
]

--
.pull-right[
&lt;img src="SSC_R_visu_Bai3_some_graph_files/figure-html/Correlogram6-1.png" width="672" /&gt;
]

---
class: center, middle
# .ssc[Ranking - biểu đồ cột (bar graph)]

---
### .ssc[`df_bar` dataset]

<div id="htmlwidget-c2c978ceeb0a3583dc0f" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-c2c978ceeb0a3583dc0f">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["1A","1B","1C","1D","Drug1","Drug2","1A","1B","1C","1D","Drug1","Drug2"],["Cell_1","Cell_1","Cell_1","Cell_1","Cell_1","Cell_1","Cell_2","Cell_2","Cell_2","Cell_2","Cell_2","Cell_2"],[5.1,1.98,1.55,2.88,9.98,1.02,9.123,3.88,2.63,3.12,18.12,2.11]],"container":"<table class=\"compact\">\n  <thead>\n    <tr>\n      <th>Group<\/th>\n      <th>Cell<\/th>\n      <th>IC50<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"tBp","buttons":["copy","excel"],"pageLength":10,"columnDefs":[{"className":"dt-right","targets":2}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>

---
### .ssc[Ranking - bar plot]

.pull-left[

```r
ggplot(data = df_bar,
       aes(x = Group, y = IC50)) +
* geom_col(
    aes(fill = Cell),  # để màu theo Cell
    width = 0.5, alpha = 0.68, color = "black", size = 0.72
  ) +
  theme_bw()
```
]

--
.pull-right[
&lt;img src="SSC_R_visu_Bai3_some_graph_files/figure-html/bar1-1.png" width="672" /&gt;
]

---
### .ssc[Ranking - bar plot]

`position = "fill"`
.pull-left[

```r
ggplot(data = df_bar,
       aes(x = Group, y = IC50)) +
  geom_col( 
    aes(fill = Cell),  # để màu theo Cell
    width = 0.5, alpha = 0.68, color = "black", size = 0.72,
*   position = "fill"
  ) +
  theme_bw()
```
]

--
.pull-right[
&lt;img src="SSC_R_visu_Bai3_some_graph_files/figure-html/bar2-1.png" width="672" /&gt;
]

---
### .ssc[Ranking - bar plot]

`position = "dodge"`
.pull-left[

```r
ggplot(data = df_bar,
       aes(x = Group, y = IC50)) +
  geom_col(
    aes(fill = Cell),  # để màu theo Cell
    width = 0.6, alpha = 0.68, color = "black", size = 0.72,
*   position = "dodge"
  ) +
  theme_bw() +
  labs( x = "", # Để trục x ko có j nếu muốn xóa
        y = "IC50 (mg/L)") +
  theme(
    axis.text.x = element_text(face = "bold", size = 12)
  )
```
]

--
.pull-right[
&lt;img src="SSC_R_visu_Bai3_some_graph_files/figure-html/bar3-1.png" width="672" /&gt;
]

---
class: center, middle
# .ssc[Evolution, Time-series]

---
### .ssc[`df_evo_2` dataset]

<div id="htmlwidget-a58fee50ebb1c9daa5ae" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-a58fee50ebb1c9daa5ae">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[[1,1,1,1,1,1,2,2,2,2,2,2,3,3,3,3,3,3,4,4,4,4,4,4],[80,80,80,80,80,80,64.6,64.6,64.6,64.6,64.6,64.6,70.5,70.5,70.5,70.5,70.5,70.5,65,65,65,65,65,65],[4,4,4,4,4,4,4.95,4.95,4.95,4.95,4.95,4.95,4.53,4.53,4.53,4.53,4.53,4.53,4.92,4.92,4.92,4.92,4.92,4.92],[0,0.27,2.03,3.57,5,23.85,0,0.25,3.48,5,6.98,24.22,0,0.25,2.02,3.53,5.05,24.12,0,0.98,1.98,3.6,12.12,24.08],[0,1.29,6.32,5.53,4.94,0.92,0.15,0.85,7.09,6.66,5.25,1.15,0,3.05,7.56,6.59,5.88,1.25,0,8,6.81,5.87,2.69,0.86]],"container":"<table class=\"compact\">\n  <thead>\n    <tr>\n      <th>Subject<\/th>\n      <th>Wt<\/th>\n      <th>Dose<\/th>\n      <th>Time<\/th>\n      <th>conc<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"tBp","buttons":["copy","excel"],"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[0,1,2,3,4]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>

---
### .ssc[Evolution - line plot]

Đối số `group`
.pull-left[

```r
ggplot(df_evo_2, aes(x = Time, y = conc)) +
  geom_line(
*   aes(group = Subject),
    color = "purple",
    size = 0.88
  ) +
  theme_bw()
```
]

--
.pull-right[
&lt;img src="SSC_R_visu_Bai3_some_graph_files/figure-html/line2-1.png" width="3733" /&gt;
]

---
### .ssc[Evolution - line plot]

Nhóm `màu` theo bệnh nhân. **Cần** chuyển biến `Subject` về dạng `factor` (hiện tại đang là biến liên tục)
.pull-left[
`group` aesthetics

```r
ggplot(df_evo_2, aes(x = Time, y = conc)) +
  geom_line(
    aes(group = Subject, 
*       color = as.factor(Subject)),
    size = 0.88
  ) +
  geom_point(aes(color = as.factor(Subject))) +
  theme_bw() +
  labs(
    x = "Th\u1EDDi gian (gi\u1EDD)",
    y = "N\u1ED3ng \u0111\u1ED9 (mg/L)",
    color = "B\u1EC7nh nh\u00E2n"
  )
```
]

--
.pull-right[
&lt;img src="SSC_R_visu_Bai3_some_graph_files/figure-html/line3-1.png" width="3733" /&gt;
]

---
### .ssc[Evolution - line plot]

Nếu các `geom_` cùng `mapping` -&gt; có thể để `map` luôn trong hàm `ggplot()` (Giống như `map` `x` và `y`)
.pull-left[
`group` aesthetics

```r
ggplot(df_evo_2, aes(x = Time, y = conc,
*                    color = as.factor(Subject))) +
  geom_line(
    # Map group chỉ dùng cho geom_line()
*   aes(group = Subject),
    size = 0.88
  ) +
  geom_point() +
  theme_bw() +
  labs(
    x = "Th\u1EDDi gian (gi\u1EDD)",
    y = "N\u1ED3ng \u0111\u1ED9 (mg/L)",
    color = "B\u1EC7nh nh\u00E2n"
  )
```
]

--
.pull-right[
&lt;img src="SSC_R_visu_Bai3_some_graph_files/figure-html/same_mapping-1.png" width="3733" /&gt;
]

---
### .ssc[Evolution - line plot]
Tương tự áp dụng cho các trường hợp khác như: kết quả thử hòa tan từ các công thức theo thời gian, kết quả thay đổi pH theo thể tích đệm pH 6.8 (thể tích đêm xem như biến time),...

---
### .ssc[Evolution - Stacked area]
Ví dụ về dữ liệu `date_time` với `df_evo_1` dataset


|Time       | Year| Month|Drug           |       DDD|
|:----------|----:|-----:|:--------------|---------:|
|2016-01-01 | 2016|     1|CiprofloxacinO | 4.2817538|
|2016-01-01 | 2016|     1|CiprofloxacinP | 2.7954615|
|2016-01-01 | 2016|     1|LevofloxacinO  | 0.0000000|
|2016-01-01 | 2016|     1|LevofloxacinP  | 0.1540199|
|2016-01-01 | 2016|     1|MoxifloxacinP  | 0.0000000|
|2016-02-01 | 2016|     2|CiprofloxacinO | 5.1242550|
|2016-02-01 | 2016|     2|CiprofloxacinP | 2.1594483|
|2016-02-01 | 2016|     2|LevofloxacinO  | 0.0000000|
|2016-02-01 | 2016|     2|LevofloxacinP  | 0.4355190|
|2016-02-01 | 2016|     2|MoxifloxacinP  | 0.0000000|
|2016-03-01 | 2016|     3|CiprofloxacinO | 6.8278741|
|2016-03-01 | 2016|     3|CiprofloxacinP | 1.8124719|
|2016-03-01 | 2016|     3|LevofloxacinO  | 0.1270302|
|2016-03-01 | 2016|     3|LevofloxacinP  | 0.1224934|
|2016-03-01 | 2016|     3|MoxifloxacinP  | 1.2231450|
|2016-04-01 | 2016|     4|CiprofloxacinO | 9.1242152|
|2016-04-01 | 2016|     4|CiprofloxacinP | 2.8687351|
|2016-04-01 | 2016|     4|LevofloxacinO  | 0.0000000|
|2016-04-01 | 2016|     4|LevofloxacinP  | 0.6825776|
|2016-04-01 | 2016|     4|MoxifloxacinP  | 1.1111511|
|2016-05-01 | 2016|     5|CiprofloxacinO | 4.1241563|
|2016-05-01 | 2016|     5|CiprofloxacinP | 2.4610298|
|2016-05-01 | 2016|     5|LevofloxacinO  | 1.6249410|
|2016-05-01 | 2016|     5|LevofloxacinP  | 0.3448276|
|2016-05-01 | 2016|     5|MoxifloxacinP  | 0.0000000|
|2016-06-01 | 2016|     6|CiprofloxacinO | 3.1452514|
|2016-06-01 | 2016|     6|CiprofloxacinP | 2.0233580|
|2016-06-01 | 2016|     6|LevofloxacinO  | 3.0167213|
|2016-06-01 | 2016|     6|LevofloxacinP  | 0.9050164|
|2016-06-01 | 2016|     6|MoxifloxacinP  | 0.8321321|
|2016-07-01 | 2016|     7|CiprofloxacinO | 5.9198925|
|2016-07-01 | 2016|     7|CiprofloxacinP | 1.8011588|
|2016-07-01 | 2016|     7|LevofloxacinO  | 4.7359140|
|2016-07-01 | 2016|     7|LevofloxacinP  | 0.5038206|
|2016-07-01 | 2016|     7|MoxifloxacinP  | 0.0000000|
|2016-08-01 | 2016|     8|CiprofloxacinO | 5.8141496|
|2016-08-01 | 2016|     8|CiprofloxacinP | 2.1523737|
|2016-08-01 | 2016|     8|LevofloxacinO  | 0.8263766|
|2016-08-01 | 2016|     8|LevofloxacinP  | 0.9359980|
|2016-08-01 | 2016|     8|MoxifloxacinP  | 0.0000000|
|2016-09-01 | 2016|     9|CiprofloxacinO | 7.4607572|
|2016-09-01 | 2016|     9|CiprofloxacinP | 2.3337950|
|2016-09-01 | 2016|     9|LevofloxacinO  | 0.2770083|
|2016-09-01 | 2016|     9|LevofloxacinP  | 1.2234534|
|2016-09-01 | 2016|     9|MoxifloxacinP  | 0.0000000|
|2016-10-01 | 2016|    10|CiprofloxacinO | 5.2241554|
|2016-10-01 | 2016|    10|CiprofloxacinP | 1.8019884|
|2016-10-01 | 2016|    10|LevofloxacinO  | 0.3498113|
|2016-10-01 | 2016|    10|LevofloxacinP  | 1.0770505|
|2016-10-01 | 2016|    10|MoxifloxacinP  | 0.0000000|
|2016-11-01 | 2016|    11|CiprofloxacinO | 7.7082730|
|2016-11-01 | 2016|    11|CiprofloxacinP | 1.8245004|
|2016-11-01 | 2016|    11|LevofloxacinO  | 1.7569263|
|2016-11-01 | 2016|    11|LevofloxacinP  | 1.5348972|
|2016-11-01 | 2016|    11|MoxifloxacinP  | 0.1214115|
|2016-12-01 | 2016|    12|CiprofloxacinO | 8.2894984|
|2016-12-01 | 2016|    12|CiprofloxacinP | 2.1698290|
|2016-12-01 | 2016|    12|LevofloxacinO  | 0.8078151|
|2016-12-01 | 2016|    12|LevofloxacinP  | 2.7193312|
|2016-12-01 | 2016|    12|MoxifloxacinP  | 0.0000000|
|2017-01-01 | 2017|     1|CiprofloxacinO | 6.8928443|
|2017-01-01 | 2017|     1|CiprofloxacinP | 3.3837057|
|2017-01-01 | 2017|     1|LevofloxacinO  | 0.4061641|
|2017-01-01 | 2017|     1|LevofloxacinP  | 1.0572214|
|2017-01-01 | 2017|     1|MoxifloxacinP  | 0.1111455|
|2017-02-01 | 2017|     2|CiprofloxacinO | 7.3185012|
|2017-02-01 | 2017|     2|CiprofloxacinP | 3.4516713|
|2017-02-01 | 2017|     2|LevofloxacinO  | 0.0000000|
|2017-02-01 | 2017|     2|LevofloxacinP  | 0.5109644|
|2017-02-01 | 2017|     2|MoxifloxacinP  | 0.0000000|
|2017-03-01 | 2017|     3|CiprofloxacinO | 5.0133929|
|2017-03-01 | 2017|     3|CiprofloxacinP | 2.8370536|
|2017-03-01 | 2017|     3|LevofloxacinO  | 2.2678571|
|2017-03-01 | 2017|     3|LevofloxacinP  | 2.5312500|
|2017-03-01 | 2017|     3|MoxifloxacinP  | 0.1339286|
|2017-04-01 | 2017|     4|CiprofloxacinO | 5.0716546|
|2017-04-01 | 2017|     4|CiprofloxacinP | 2.7870836|
|2017-04-01 | 2017|     4|LevofloxacinO  | 3.3221664|
|2017-04-01 | 2017|     4|LevofloxacinP  | 2.7079844|
|2017-04-01 | 2017|     4|MoxifloxacinP  | 0.1023637|
|2017-05-01 | 2017|     5|CiprofloxacinO | 5.7296725|
|2017-05-01 | 2017|     5|CiprofloxacinP | 3.0303699|
|2017-05-01 | 2017|     5|LevofloxacinO  | 1.7921780|
|2017-05-01 | 2017|     5|LevofloxacinP  | 2.7809658|
|2017-05-01 | 2017|     5|MoxifloxacinP  | 0.0794562|
|2017-06-01 | 2017|     6|CiprofloxacinO | 6.1060525|
|2017-06-01 | 2017|     6|CiprofloxacinP | 3.7270130|
|2017-06-01 | 2017|     6|LevofloxacinO  | 3.5797179|
|2017-06-01 | 2017|     6|LevofloxacinP  | 1.5577575|
|2017-06-01 | 2017|     6|MoxifloxacinP  | 0.0000000|
|2017-07-01 | 2017|     7|CiprofloxacinO | 5.3735836|
|2017-07-01 | 2017|     7|CiprofloxacinP | 3.5543555|
|2017-07-01 | 2017|     7|LevofloxacinO  | 1.2393768|
|2017-07-01 | 2017|     7|LevofloxacinP  | 1.3854462|
|2017-07-01 | 2017|     7|MoxifloxacinP  | 0.0000000|
|2017-08-01 | 2017|     8|CiprofloxacinO | 6.5793029|
|2017-08-01 | 2017|     8|CiprofloxacinP | 2.5983968|
|2017-08-01 | 2017|     8|LevofloxacinO  | 0.7115194|
|2017-08-01 | 2017|     8|LevofloxacinP  | 1.1843646|
|2017-08-01 | 2017|     8|MoxifloxacinP  | 0.0090066|
|2017-09-01 | 2017|     9|CiprofloxacinO | 7.2821558|
|2017-09-01 | 2017|     9|CiprofloxacinP | 3.1180746|
|2017-09-01 | 2017|     9|LevofloxacinO  | 3.4925982|
|2017-09-01 | 2017|     9|LevofloxacinP  | 1.3695594|
|2017-09-01 | 2017|     9|MoxifloxacinP  | 0.0443223|
|2017-10-01 | 2017|    10|CiprofloxacinO | 5.3396311|
|2017-10-01 | 2017|    10|CiprofloxacinP | 3.1781377|
|2017-10-01 | 2017|    10|LevofloxacinO  | 2.5551057|
|2017-10-01 | 2017|    10|LevofloxacinP  | 1.8353576|
|2017-10-01 | 2017|    10|MoxifloxacinP  | 0.0000000|
|2017-11-01 | 2017|    11|CiprofloxacinO | 5.6254200|
|2017-11-01 | 2017|    11|CiprofloxacinP | 3.8014784|
|2017-11-01 | 2017|    11|LevofloxacinO  | 2.7167131|
|2017-11-01 | 2017|    11|LevofloxacinP  | 2.6159163|
|2017-11-01 | 2017|    11|MoxifloxacinP  | 0.0767975|
|2017-12-01 | 2017|    12|CiprofloxacinO | 9.0191097|
|2017-12-01 | 2017|    12|CiprofloxacinP | 5.3048713|
|2017-12-01 | 2017|    12|LevofloxacinO  | 0.8615928|
|2017-12-01 | 2017|    12|LevofloxacinP  | 2.3362421|
|2017-12-01 | 2017|    12|MoxifloxacinP  | 0.1215067|
|2018-01-01 | 2018|     1|CiprofloxacinO | 5.6572541|
|2018-01-01 | 2018|     1|CiprofloxacinP | 3.2229796|
|2018-01-01 | 2018|     1|LevofloxacinO  | 0.0000000|
|2018-01-01 | 2018|     1|LevofloxacinP  | 1.8451801|
|2018-01-01 | 2018|     1|MoxifloxacinP  | 0.1265823|
|2018-02-01 | 2018|     2|CiprofloxacinO | 6.8367079|
|2018-02-01 | 2018|     2|CiprofloxacinP | 3.9705496|
|2018-02-01 | 2018|     2|LevofloxacinO  | 0.0000000|
|2018-02-01 | 2018|     2|LevofloxacinP  | 2.4848804|
|2018-02-01 | 2018|     2|MoxifloxacinP  | 0.0262950|
|2018-03-01 | 2018|     3|CiprofloxacinO | 7.9569420|
|2018-03-01 | 2018|     3|CiprofloxacinP | 4.0839192|
|2018-03-01 | 2018|     3|LevofloxacinO  | 0.2425353|
|2018-03-01 | 2018|     3|LevofloxacinP  | 1.6212654|
|2018-03-01 | 2018|     3|MoxifloxacinP  | 0.3075571|
|2018-04-01 | 2018|     4|CiprofloxacinO | 8.0070834|
|2018-04-01 | 2018|     4|CiprofloxacinP | 3.7235570|
|2018-04-01 | 2018|     4|LevofloxacinO  | 0.1242526|
|2018-04-01 | 2018|     4|LevofloxacinP  | 2.2111611|
|2018-04-01 | 2018|     4|MoxifloxacinP  | 0.1148655|
|2018-05-01 | 2018|     5|CiprofloxacinO | 7.4538317|
|2018-05-01 | 2018|     5|CiprofloxacinP | 4.0347043|
|2018-05-01 | 2018|     5|LevofloxacinO  | 0.0000000|
|2018-05-01 | 2018|     5|LevofloxacinP  | 2.5827460|
|2018-05-01 | 2018|     5|MoxifloxacinP  | 0.0892140|
|2018-06-01 | 2018|     6|CiprofloxacinO | 8.0508475|
|2018-06-01 | 2018|     6|CiprofloxacinP | 4.5506709|
|2018-06-01 | 2018|     6|LevofloxacinO  | 0.0000000|
|2018-06-01 | 2018|     6|LevofloxacinP  | 1.4477401|
|2018-06-01 | 2018|     6|MoxifloxacinP  | 0.0617938|
|2018-07-01 | 2018|     7|CiprofloxacinO | 7.7631891|
|2018-07-01 | 2018|     7|CiprofloxacinP | 5.2618050|
|2018-07-01 | 2018|     7|LevofloxacinO  | 0.0000000|
|2018-07-01 | 2018|     7|LevofloxacinP  | 0.0000000|
|2018-07-01 | 2018|     7|MoxifloxacinP  | 0.1265522|
|2018-08-01 | 2018|     8|CiprofloxacinO | 8.3110025|
|2018-08-01 | 2018|     8|CiprofloxacinP | 4.1357976|
|2018-08-01 | 2018|     8|LevofloxacinO  | 0.0000000|
|2018-08-01 | 2018|     8|LevofloxacinP  | 0.0000000|
|2018-08-01 | 2018|     8|MoxifloxacinP  | 0.2127995|
|2018-09-01 | 2018|     9|CiprofloxacinO | 7.6823565|
|2018-09-01 | 2018|     9|CiprofloxacinP | 4.3287889|
|2018-09-01 | 2018|     9|LevofloxacinO  | 1.2415256|
|2018-09-01 | 2018|     9|LevofloxacinP  | 1.1141450|
|2018-09-01 | 2018|     9|MoxifloxacinP  | 0.2686835|
|2018-10-01 | 2018|    10|CiprofloxacinO | 6.3628358|
|2018-10-01 | 2018|    10|CiprofloxacinP | 5.1871422|
|2018-10-01 | 2018|    10|LevofloxacinO  | 1.7893523|
|2018-10-01 | 2018|    10|LevofloxacinP  | 0.0000000|
|2018-10-01 | 2018|    10|MoxifloxacinP  | 0.0440335|
|2018-11-01 | 2018|    11|CiprofloxacinO | 9.0790162|
|2018-11-01 | 2018|    11|CiprofloxacinP | 4.8665620|
|2018-11-01 | 2018|    11|LevofloxacinO  | 1.9214721|
|2018-11-01 | 2018|    11|LevofloxacinP  | 1.4148015|
|2018-11-01 | 2018|    11|MoxifloxacinP  | 0.0087214|
|2018-12-01 | 2018|    12|CiprofloxacinO | 8.8887857|
|2018-12-01 | 2018|    12|CiprofloxacinP | 5.9274044|
|2018-12-01 | 2018|    12|LevofloxacinO  | 0.0000000|
|2018-12-01 | 2018|    12|LevofloxacinP  | 0.0000000|
|2018-12-01 | 2018|    12|MoxifloxacinP  | 0.0000000|

---
### .ssc[Evolution - Stacked area]
Ví dụ về dữ liệu `date_time`
- Lưu ý cần lưu trữ kiểu biến ở dạng `date` trên `excel`
- Cần biến đổi biến về dạng `Date` trên R thông qua lệnh:

```r
df_evo_1$Time = as.Date(df_evo_1$Time)
```

---
### .ssc[Evolution - Stacked area]

Ví dụ biểu diễn dưới dạng `line` chồng lấp khó theo dõi
.pull-left[

```r
ggplot(df_evo_1, aes(x = Time, y = DDD)) +
  geom_line(aes(color = Drug), size = 0.88) +
  labs(
    x = "", y = "DDD/100 ng\u00E0y n\u1EB1m vi\u1EC7n",
    color = "Thu\u1ED1c_\u0110\u01B0\u1EDDng d\u00F9ng"
  ) +
  theme_bw()
```
]

--
.pull-right[
&lt;img src="SSC_R_visu_Bai3_some_graph_files/figure-html/line4-1.png" width="3733" /&gt;
]

---
### .ssc[Evolution - Stacked area]

.pull-left[
Chuyển quan dạng `Stacked area`

```r
ggplot(df_evo_1, aes(x = Time, y = DDD)) +
* geom_area(aes(fill = Drug)) +
  labs(
    x = "", y = "DDD/100 ng\u00E0y n\u1EB1m vi\u1EC7n",
    color = "Thu\u1ED1c_\u0110\u01B0\u1EDDng d\u00F9ng"
  ) +
  theme_bw()
```
]

--
.pull-right[
&lt;img src="SSC_R_visu_Bai3_some_graph_files/figure-html/line5-1.png" width="3733" /&gt;
]

---
### .ssc[Evolution - Stacked area]

.pull-left[
Tùy chình thêm

```r
ggplot(df_evo_1, aes(x = Time, y = DDD)) +
  geom_area(aes(fill = Drug),
*           alpha = 0.68, color = "white", size = 0.6) +
  labs(
    x = "", y = "DDD/100 ng\u00E0y n\u1EB1m vi\u1EC7n",
    color = "Thu\u1ED1c_\u0110\u01B0\u1EDDng d\u00F9ng",
    fill = "Thu\u1ED1c"
  ) +
  theme_bw()
```
]

--
.pull-right[
&lt;img src="SSC_R_visu_Bai3_some_graph_files/figure-html/line6-1.png" width="3733" /&gt;
]

---
### .ssc[Evolution - Stacked area]

.pull-left[
Chỉnh hiển thị `ngày tháng`

```r
ggplot(df_evo_1, aes(x = Time, y = DDD)) +
  geom_area(aes(fill = Drug),
            alpha = 0.68, color = "white", size = 0.6) + 
* scale_x_date(
    # Hiển thị tháng và năm
    date_labels = "%m/%Y", 
    # Chia khoảng 4 năm
    date_breaks = "4 months"
  ) +
  labs(
    x = "", y = "DDD/100 ng\u00E0y n\u1EB1m vi\u1EC7n",
    color = "Thu\u1ED1c_\u0110\u01B0\u1EDDng d\u00F9ng",
    fill = "Thu\u1ED1c"
  ) +
  theme_bw()
```
]

--
.pull-right[
&lt;img src="SSC_R_visu_Bai3_some_graph_files/figure-html/line7-1.png" width="3733" /&gt;
]

---
class: center, middle
# .ssc[Một số biểu đồ có *statistic*]

---
### .ssc[Đường chuẩn - Tự tạo dataset]


```r
df_cal_curve = data.frame(
  Nong_do = 1:10,
  S_peak = c(1.04, 1.95, 3.06, 4.04, 4.66, 5.58, 6.91, 8.74, 9.78, 10.14)
)
```

| Nong_do| S_peak|
|-------:|------:|
|       1|   1.04|
|       2|   1.95|
|       3|   3.06|
|       4|   4.04|
|       5|   4.66|
|       6|   5.58|
|       7|   6.91|
|       8|   8.74|
|       9|   9.78|
|      10|  10.14|

---
### .ssc[Đường chuẩn]

.pull-left[

```r
ggplot(df_cal_curve, aes(x = Nong_do, y = S_peak)) +
  geom_point() +
  stat_smooth(
    method = "lm", se = FALSE, 
    color = "black", size = 0.6
  ) +
  theme_minimal() 
```
]

--
.pull-right[
&lt;img src="SSC_R_visu_Bai3_some_graph_files/figure-html/cal_curve-1.png" width="3733" /&gt;
]

---
### .ssc[Đường chuẩn]

Vẽ thêm đường `SE`
.pull-left[

```r
ggplot(df_cal_curve, aes(x = Nong_do, y = S_peak)) +
  geom_point() +
  stat_smooth(
    method = "lm", se = TRUE, 
    color = "black", size = 0.6
  ) +
  theme_minimal()
```
]

--
.pull-right[
&lt;img src="SSC_R_visu_Bai3_some_graph_files/figure-html/cal_curve2-1.png" width="3733" /&gt;
]

---
### .ssc[Đường chuẩn]

Thêm phương trình và hệ số xác định `R^2`
.pull-left[

```r
ggplot(df_cal_curve, aes(x = Nong_do, y = S_peak)) +
  geom_point() +
  theme_minimal() +
  stat_smooth(method = "lm", se = TRUE, color = "black", size = 0.6) +
* stat_poly_eq(
*   formula = y ~ x,
*   eq.with.lhs = "italic(hat(y))~`=`~",
*   aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
*   parse = TRUE
  ) 
```
]

--
.pull-right[
&lt;img src="SSC_R_visu_Bai3_some_graph_files/figure-html/cal_curve1-1.png" width="3733" /&gt;
]

---
class: center, middle
# .ssc[Biểu đồ chứa sai số (error bar)]

---
### .ssc[`df_bar_error` dataset]

<div id="htmlwidget-86467c068c0959f53693" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-86467c068c0959f53693">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["1A","1B","1C","1D","Drug1","Drug2","1A","1B","1C","1D","Drug1","Drug2"],["Cell_1","Cell_1","Cell_1","Cell_1","Cell_1","Cell_1","Cell_2","Cell_2","Cell_2","Cell_2","Cell_2","Cell_2"],[5.1,1.98,1.55,2.88,9.98,1.02,9.123,3.88,2.63,3.12,18.12,2.11],[0.52,0.32,0.18,0.12,1.88,0.55,1.35,0.22,0.1,0.06,0.86,1.88]],"container":"<table class=\"compact\">\n  <thead>\n    <tr>\n      <th>Group<\/th>\n      <th>Cell<\/th>\n      <th>IC50_mean<\/th>\n      <th>SD<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"tBp","buttons":["copy","excel"],"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[2,3]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>

---
### .ssc[Barplot with error bar]
Ví dụ mean `\(\pm\)` SD. Tương tự vẽ cho khoảng tin cậy 95% (`95CI`)

.pull-left[

```r
ggplot(data = df_bar_error,
       # Cần để aes(fill) luôn từ đầu 
       aes(x = Group, y = IC50_mean, 
*          fill = Cell)) +
  geom_col(
    width = 0.6, alpha = 0.68, color = "black", size = 0.72,
    position = "dodge"
  ) +
  geom_errorbar(
    aes(ymin = IC50_mean - SD, ymax = IC50_mean + SD), 
    width = .2, size = 0.22, 
    # Chỉnh vị trí của thanh error
*   position = position_dodge(.6)
  ) +
  theme_bw() +
  labs( x = "", y = "IC50 (mg/L)") +
  theme(
    axis.text.x = element_text(face = "bold", size = 12)
  )
```
]

--
.pull-right[
&lt;img src="SSC_R_visu_Bai3_some_graph_files/figure-html/error_bar-1.png" width="672" /&gt;
]

---
class: center, middle
&lt;img src="tks_slide.png" width="60%" height="60%" /&gt;

---
class: center, middle
&lt;img src="happy-monday-3.gif" width="50%" height="50%" /&gt;


















    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9",
"navigation": {
"scroll": false
}
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>
<style>
.logo {
  background-image: url(logoADR.png);
  background-size: contain;
  background-repeat: no-repeat;
  position: absolute;
  top: 1.2em;
  right: 5em;
  width: 110px;
  height: 112px;
  z-index: 0;
}
</style>

<script>
document
  .querySelectorAll(
    '.remark-slide-content' +
    ':not(.title-slide)' +
    // add additional classes to exclude here, e.g.
    // ':not(.inverse)' +
    ':not(.hide-logo)'
  )
  .forEach(el => {
    el.innerHTML += '<div class="logo"></div>';
  });
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
